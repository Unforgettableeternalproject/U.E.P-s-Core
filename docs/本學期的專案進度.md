# U.E.P 桌面智慧助理專案

## 2025學年度第2學期成果報告 

---

### 一、專案目標與發展構想

本專案**U.E.P（Unified Experience Partner）**旨在開發一套具備高擴充性、可模組化整合的**桌面型互動助理**，期望讓電腦能主動參與工作流程，協助使用者完成語音互動、資訊整理、檔案管理與自動化任務。
U.E.P 不僅是語音助理，更是一套結合 NLP、記憶、智慧推論、動畫與多媒體控制的完整平台。
本學期主要聚焦於底層核心架構、六大功能模組（語音/文字/記憶/推理/合成/系統）、測試機制及功能整合，為後續的完整互動介面、前端動畫和進階 AI 應用打下堅實基礎。

---

### 二、專案分期開發規劃

| 階段 | 目標內容           | 本學期進度     |
| -- | -------------- | --------- |
| 一  | **核心模組建置與測試**  | ⬛ 已完成 (v0.1.0) |
| 二  | **模組重構、核心系統設計、UI雛型** | ⬛ 已完成 (v0.7.4)     |
| 三  | **前後端整合、特殊狀態、系統監控**  | � 穩定發布 70% (v0.9.4-stable)  | 
| 四  | 多平台適配、真實部署     | ⬜ 未開始     |

---

### 三、本學期主要成果與進度

**重要里程碑**: 本學期完成 Phase 2 架構重構 (v0.7.4) 並進入 Phase 3 前後端整合階段 (v0.8.0-rc1)，目前整體專案完成度約 **92%**。

#### (一) 六大核心模組架構 (Phase 1-2 完成)

1. **STT（Speech-To-Text）語音辨識**

   * 實作基於 speech\_recognition 套件，具備即時麥克風輸入與基本語音辨識。
   * 缺少功能：未支援喚醒詞、聲音活動偵測 (VAD)、使用者辨識


   * 未來規劃：


    a. 整合感應式錄製（無需明確關鍵詞即可觸發）
    
    b. 聯動 MEM 模組，自動學習使用者語音特徵以識別身份

    c. 支援快取最近錄音音訊，用於 NLP 模組的後處理

2. **NLP（自然語言理解）**

   * 使用 DistilBERT/自訓模型區分聊天、指令及雜訊，實現意圖判斷與簡易主題分類。
   
   * 未來擴充：

    a. 聊天主題辨識與自動命名快照（Topic Labeling）

    b. 與 SYS 模組聯動，擷取功能需求資訊（例如檔案/程式名稱）

    c. 處理多輪上下文，為 MEM 提供快照整理依據

    d. 聊天/工作複合型處理

3. **MEM（記憶管理）**

   * 採用本地向量資料庫（FAISS）、sliding window 記憶快取及摘要機制，支援歷史對話追蹤、主題動態切換。

   * 未來擴充：

    a. 快照管理與主題鏈結（動態追蹤上下文）

    b. 建立短期記憶（快取）與長期記憶（資料庫）分層架構

    c. 根據 NLP 標記選取最適摘要範圍回傳給 LLM
     
4. **LLM（大型語言模型介接）**

   * 串接 Google Gemini API，可根據 intent 及上下文生成回應，支援 JSON 參數輸入/輸出。
   * 預留 Content Caching、系統指示、mood 控制等未來擴充介面。

5. **TTS（語音合成）**

   * 結合 edge_tts 與 RVC (Retrieval-based Voice Conversion) 進行多語音風格合成，可直接本地化推理與聲音處理。

6. **SYS（系統功能控制）**

   * 系統功能分類明確，模組化規劃為五大行動類型：
     a. 檔案互動（讀檔、歸檔、摘要等）
     b. 桌面/視窗控制（視窗推動、工作區切換、截圖標註等）
     c. 剪貼簿/文字處理（片語快速貼上、歷史查詢、OCR 等）
     d. 自動化助手（行程提醒、備份腳本、資料夾監控等）
     e. 外部整合（新聞摘要、天氣查詢、程式碼分析、多媒體控制）

#### (二) Phase 2 架構重構 (v0.7.4 完成)

**事件驅動架構轉型** (完成度 96%):
* Event Bus 系統實現 20+ 種系統事件，實現模組間鬆耦合通訊
* 三層處理模型：Input Layer (STT/NLP) → Processing Layer (MEM/LLM/SYS) → Output Layer (TTS/UI)
* 三層會話管理：General Session (GS) / Chatting Session (CS) / Workflow Session (WS)
* Working Context 協作通道 (CHAT_MEM, WORK_SYS) 實現跨模組資料交換
* 狀態-會話一體化：狀態轉換自動創建對應會話
* Flow-based 去重機制防止重複處理

**關鍵成就**:
* MCP 協議整合實現 LLM tool-calling，支援互動式工作流
* 身份隔離記憶系統，每個使用者獨立 FAISS 索引
* StatusManager 動態追蹤 mood/pride/helpfulness
* Context Caching 減少 API 調用成本

#### (三) Phase 3 前後端整合 (v0.8.0-rc1 進行中，完成度 70%)

**1. 前後端橋接系統** (完成度 90%):
* **Frontend Bridge**: 統一管理 UI/MOV/ANI 三大前端模組，實現事件訂閱與分發
* **雙重事件系統**: 系統 Event Bus + 前端 Event Bus 各司其職
* **使用者工具三視窗**:
  - 系統狀態面板：顯示系統性能、模組健康度、運行時間
  - 使用者設定面板：完整的分類設定介面，支援熱重載
  - 系統監控面板：背景任務管理、音樂播放控制
* **快速動作按鈕**:
  - 顯示/隱藏 UEP：一鍵切換桌面寵物可見性
  - ON_CALL 呼叫：快速輸入對話框，支援 VAD/文字雙模式
  - 睡眠切換：SLEEP/WAKE 狀態快速切換
* **自動隱藏小工具**: 邊緣感應收合，虛擬桌面邊界計算

**2. 特殊狀態實現** (完成度 92%):
* **MISCHIEF 狀態** (100% 完成):
  - 5 種搗蛋行為：移動視窗、創建文件、點擊捷徑、移動滑鼠、語音輸出
  - LLM 驅動的創意行為規劃（溫度 0.9）
  - 執行引擎含失敗跳過機制
  - 根據執行結果調整系統數值 (mood/boredom/pride)
* **SLEEP 狀態** (85% 完成):
  - 資源釋放機制：卸載後端模組 (STT/LLM/TTS)
  - 快速喚醒機制：模組重載追蹤，WAKE_READY 事件
  - 動畫整合：睡眠/喚醒動畫播放

**3. 智能 VAD 啟動** (完成度 90%):
* 基於 CALL 意圖的語音觸發機制
* VAD/文字輸入雙模式支援
* 狀態感知的啟動控制 (IDLE 需 CALL，CHAT 無需 CALL)
* 降低誤觸發率

**4. 工作流強化** (完成度 45%):
* ✅ Play Media 工作流完整實現 (90%):
  - 背景播放監控任務
  - 實時控制：播放/暫停/下一首/音量調整
  - VLC/pydub 雙引擎支援
* ✅ 記憶系統工具化 (80%):
  - Tool-based 記憶檢索而非預先注入
  - LLM 可主動調用 memory_retrieval 工具
* ❌ 子工作流系統尚未實現
* ❌ 自然語言路徑解析待開發

**5. 系統監控與效能指標** (完成度 72%):
* 模組效能指標自動收集 (85%)
* User Gadget 與 Debug GUI 實時展示 (90%)
* 效能歷史追蹤（最近 10 個快照）
* 基礎例外記錄機制 (40%)

**6. 模組結構統一** (完成度 30%):
* 部分模組已有子結構 (MEM, SYS, UI, MOV)
* 完整統一重構進行中

#### (四) 系統架構設計

* 採用「事件驅動」與「分層」設計，所有模組通過 Event Bus 進行鬆耦合通訊。
* 每一個模組皆以標準化 Pydantic schemas/config/init 進行開發，便於團隊協作與未來增強。
* 建立 MCP 協議標準，支援 LLM function-calling 與互動式工作流。
* Frontend Bridge 實現前後端統一協調，事件驅動動畫與行為。

#### (五) 測試與驗證流程

* 開發完整的**整合測試框架** (integration_tests/)，涵蓋關鍵路徑驗證。
* 測試覆蓋率約 60%，包含：
  - 完整聊天路徑整合測試
  - 工作流執行週期測試
  - 記憶 MCP 整合測試
  - MISCHIEF/LLM 整合測試
* 日誌系統分級管理 (debug/runtime/error)，方便追蹤及除錯。
* 效能基準測試框架建立中。

#### (六) 進度文檔與設計紀錄

* 每階段皆留存規劃文檔、系統設計文件 (SDD)、階段進度文檔，可供隨時調閱。
* 維護 VERSION_HISTORY.md 記錄版本變更。
* 隱藏文檔 (hidden_docs/) 記錄架構債務、重構計劃、實現總結。

---

### 四、目前可展示內容（Demo/文件）

**核心功能展示**:
* 各模組皆可獨立測試，並能串連完整的對話/工作流 pipeline
* 完整的使用者工具介面 (Access Widget)：
  - 系統狀態監控面板
  - 使用者設定管理面板
  - 背景任務與媒體控制面板
* 快速動作按鈕實際運作：顯示/隱藏、ON_CALL 呼叫、睡眠切換
* MISCHIEF 狀態演示：LLM 規劃搗蛋行為並執行
* SLEEP/WAKE 狀態演示：資源釋放與快速喚醒

**技術特性展示**:
* Event Bus 事件流追蹤與歷史查看
**中期目標 (v1.0.0 Phase 4)**:
* 多平台適配 (Windows/Linux/macOS)
* 效能優化與資源管理
* 公開測試與使用者反饋收集
* 完善七、結語

U.E.P 團隊已成功完成 Phase 2 事件驅動架構重構，並在 Phase 3 前後端整合階段取得顯著進展 (70% 完成)。本學期的主要成就包括：

1. **完整的事件驅動架構**: Event Bus 系統實現模組間鬆耦合通訊
2. **前後端橋接系統**: Frontend Bridge 統一管理前端模組
3. **特殊狀態機制**: MISCHIEF 與 SLEEP 狀態完整實現
4. **智能 VAD 啟動**: 基於意圖的語音觸發降低誤觸發
5. **使用者工具完成**: 三視窗管控介面與快速動作按鈕
6. **完整測試框架**: 整合測試涵蓋關鍵路徑

當前系統整體完成度約 **92%**，已具備穩定的核心功能與完整的前後端整合。接下來將專注於完善遺留功能（子工作流、路徑解析、例外管理）並進行充分的穩定性測試，為 v1.0.0 正式版本做好準備。

感謝老師的指導與建議，未來將持續提升專案品質、優化使用體驗，並致力於推動 AI 助理新型態的應用實踐。

---

**當前版本**: v0.9.4-stable  
**下一里程碑**: v0.10.0 (Phase 3 完成，預計 2026 Q1)  
**最終目標**: v1.0.0 (Phase 4 完成，預計 2026 Q2-Q3)
* 建立 U.E.P 作為開放式 AI 助理平台
* 支援插件系統與社群擴展
* 多語言支援
* 雲端同步與跨裝置協作

---

### 七重載機制

**文檔資源**:
* 完整的系統設計文件 (docs/SDD/)
* 階段進度文檔 (第二/三階段進度.md)
* 版本歷史記錄 (VERSION_HISTORY.md)
* 雙語 README (中文/英文)
* 整合測試報告

---

### 五、當前技術成就總結

**架構層面**:
1. **事件驅動架構**: Event Bus + Frontend Bridge 雙重事件系統
2. **三層處理模型**: 完整的輸入→處理→輸出流程
3. **MCP 協議整合**: 業界標準 tool-calling 實現
4. **會話-狀態一體化**: 狀態自動管理會話生命週期

**功能層面**:
1. **前後端完整整合**: Frontend Bridge 統一協調
2. **特殊狀態機制**: MISCHIEF/SLEEP 無縫整合
3. **智能語音觸發**: 基於意圖的 VAD 啟動
4. **完整媒體控制**: 背景監控 + 實時干涉
5. **記憶系統工具化**: 主動檢索而非被動注入

**體驗層面**:
1. **使用者工具三視窗**: 完整的系統管控介面
2. **快速動作一鍵操作**: 提升互動效率
3. **自動隱藏小工具**: 不遮擋工作區域
4. **配置熱重載**: 無需重啟即時生效
5. **主題系統**: 深色/淺色/高對比度切換

**當前版本**: v0.8.0-rc1 (Release Candidate 1)  
**整體完成度**: 約 92% (Phase 3 核心目標 70-75%)

---

### 六、未來規劃

**短期目標 (v0.8.0-rc2 → v0.8.0-stable)**:
* 完成子工作流系統實現
* 實現自然語言路徑解析
* 完善例外管理機制
* 提升整合測試覆蓋率至 80%+
* 模組結構統一化重構

**中期目標 (v1.0.0 Phase 4)**:
* 執行長期穩定測試，並規劃多平台部署與後續釋出。

---

### 六、結語

U.E.P 團隊已建立強健的核心架構，完成關鍵模組整合、流程標準化與功能設計，本學期成果紮實，並為下階段的完整互動應用與創新功能開發奠定堅實基礎。
感謝老師的指導與建議，未來將持續提升專案品質、優化使用體驗，並致力於推動 AI 助理新型態的應用實踐。

---

**（附錄：可提供 modules/functions.yaml、主要進度文檔、測試紀錄或簡要架構圖）**

---