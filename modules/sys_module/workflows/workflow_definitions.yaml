# U.E.P System Module Workflow Definitions
#
# 這個文件定義了所有可用的工作流，包括：
# - 工作流的基本信息（名稱、描述、分類）
# - 可接受的初始參數（用於工作流加速）
# - MCP Tool 生成所需的參數定義
#
# 初始參數機制：
# - LLM 可以從用戶輸入中提取初始參數
# - 如果提供了初始參數，工作流會跳過相應的互動步驟
# - 這使得工作流能夠更快速地響應用戶需求
#
# 注意：file_selection 類型的參數暫時保持 optional: false
#       未來會在前端紙盒實現後改為 optional: true

workflows:
  # ==================== File Workflows ====================
  
  drop_and_read:
    name: "drop_and_read"
    description: "Read file content and provide summary using LLM"
    category: "file"
    work_mode: "direct"
    
    initial_params:
      file_path_input:
        type: str
        optional: false
        description: "Path to the file to read"
        maps_to_step: "file_path_input"
        extraction_hint: "Extract file paths from user input"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: file_path_input (optional file path)"

  intelligent_archive:
    name: "intelligent_archive"
    description: "Archive files to organized folders using LLM suggestions"
    category: "file"
    work_mode: "direct"
    
    initial_params:
      file_selection:
        type: str
        optional: false
        description: "Path to the file to archive"
        maps_to_step: "file_selection"
        extraction_hint: "Extract file paths from user input"
      
      target_dir_input:
        type: str
        optional: true
        description: "Target directory for archiving (optional, LLM will suggest if not provided)"
        maps_to_step: "target_dir_input"
        extraction_hint: "Extract directory paths from phrases like archive to Documents, move to folder X"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: file_selection (required), target_dir_input (optional)"

  summarize_tag:
    name: "summarize_tag"
    description: "Generate summary and tags for a file using LLM"
    category: "file"
    work_mode: "direct"
    
    initial_params:
      file_path_input:
        type: str
        optional: false
        description: "Path to the file to summarize"
        maps_to_step: "file_path_input"
        extraction_hint: "Extract file paths from user input"
      
      num_tags:
        type: int
        optional: true
        description: "Number of tags to generate (default: 5)"
        maps_to_step: "num_tags_input"
        extraction_hint: "Extract numbers from phrases like generate 10 tags, 5 keywords"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: file_path_input (required), num_tags (default: 5)"

  # ==================== Info Workflows ====================
  
  get_weather:
    name: "get_weather"
    description: "Get weather information for a specific location using wttr.in API"
    category: "info"
    work_mode: "direct"
    
    initial_params:
      location:
        type: str
        optional: true
        description: "City name or location (supports Chinese or English)"
        maps_to_step: "location_input"
        extraction_hint: "Extract location/city names from user input, e.g., Tokyo, Taipei, 台北"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: location (optional, Chinese or English city name)"

  get_world_time:
    name: "get_world_time"
    description: "Get current time in different timezones: UTC, specific timezone, or local time"
    category: "info"
    work_mode: "direct"
    
    initial_params:
      target_num:
        type: int
        optional: true
        description: "Time query mode: 1=UTC, 2=specific timezone, 3=local time"
        maps_to_step: "mode_selection"
        extraction_hint: "If query mentions specific location/timezone (Tokyo, New York, etc.) → 2. If asks for UTC → 1. If asks for local/current time → 3. Default to 2 if location mentioned."
        infer_from:
          - param: "tz"
            condition: "exists"
            value: 2
            reason: "If timezone is provided, mode must be 2 (specific timezone)"
      
      tz:
        type: str
        optional: true
        description: "Timezone name (e.g., Tokyo, Taiwan, New York) - only needed when target_num=2"
        maps_to_step: "timezone_input"
        extraction_hint: "Extract location/city names from query (Tokyo, New York, Taipei, 東京, etc.). Required when target_num=2."
        condition: "target_num == 2"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: target_num (1=UTC, 2=timezone, 3=local), tz (timezone name for mode 2)"

  news_summary:
    name: "news_summary"
    description: "Quick peek at latest Taiwan news headlines (6 items) from Google News Taiwan. LLM will summarize headlines in English."
    category: "info"
    work_mode: "direct"
    
    initial_params: {}  # No parameters needed - fixed source and count
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"

  # ==================== Text Workflows ====================
  
  clipboard_tracker:
    name: "clipboard_tracker"
    description: "Search clipboard history for specific keywords or view recent items"
    category: "text"
    work_mode: "direct"
    
    initial_params:
      keyword:
        type: str
        optional: true
        description: "Search keyword (empty to view recent history)"
        maps_to_step: "keyword_input"
        extraction_hint: "Extract search terms from user input"
      
      max_results:
        type: int
        optional: true
        description: "Maximum number of results to return (default: 5)"
        maps_to_step: "max_results_input"
        extraction_hint: "Extract numbers like show 10 items, last 5 copies"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: keyword (optional), max_results (default 5)"

  quick_phrases:
    name: "quick_phrases"
    description: "Get predefined text templates or generate custom templates using LLM"
    category: "text"
    work_mode: "direct"
    
    initial_params:
      template_name:
        type: str
        optional: true
        description: "Template name (e.g., email, meeting, thanks)"
        maps_to_step: "template_selection"
        extraction_hint: "Extract template names from user input"
      
      custom_prompt:
        type: str
        optional: true
        description: "Custom prompt for LLM to generate template (English)"
        maps_to_step: "custom_prompt_input"
        extraction_hint: "If user asks to generate/create template, extract their requirements"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: template_name (optional), custom_prompt (optional, English)"

  ocr_extract:
    name: "ocr_extract"
    description: "Extract text from images using OCR (supports Chinese Traditional and English)"
    category: "text"
    work_mode: "direct"
    
    initial_params:
      image_path:
        type: str
        optional: false
        description: "Path to the image file"
        maps_to_step: "image_path_step"
        extraction_hint: "Extract file paths from user input"
      
      target_num:
        type: int
        optional: true
        description: "Output format: 1=text (default), 2=PDF"
        maps_to_step: "target_selection"
        extraction_hint: "1 for text, 2 if user mentions PDF"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: image_path (required), target_num (1=text, 2=PDF)"

  # ==================== Analysis Workflows ====================
  
  code_analysis:
    name: "code_analysis"
    description: "Analyze code using LLM with different analysis types: general, security, optimize, explain"
    category: "analysis"
    work_mode: "direct"
    
    initial_params:
      code:
        type: str
        optional: false
        description: "Code to analyze"
        maps_to_step: "code_input"
        extraction_hint: "Extract code from user input (in code blocks or plain text)"
      
      analysis_type:
        type: str
        optional: true
        description: "Analysis type: general (default), security, optimize, explain"
        maps_to_step: "analysis_type_selection_step"
        extraction_hint: "Extract from keywords: security=security, optimize/improve=optimize, explain=explain"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: code (required), analysis_type (default: general)"

  # ==================== Utility Workflows ====================
  
  clean_trash_bin:
    name: "clean_trash_bin"
    description: "Clean system trash bin/recycle bin (supports Windows, macOS, Linux)"
    category: "utility"
    work_mode: "direct"
    
    initial_params: {}
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "No additional data needed"

  translate_document:
    name: "translate_document"
    description: "Translate documents (PDF, DOCX, TXT) using LLM, supports 20 languages"
    category: "utility"
    work_mode: "direct"
    
    initial_params:
      file_path:
        type: str
        optional: false
        description: "Path to the document file"
        maps_to_step: "file_path_input_step"
        extraction_hint: "Extract file paths from user input"
      
      target_lang:
        type: str
        optional: true
        description: "Target language (default: zh-tw)"
        maps_to_step: "target_lang_step"
        extraction_hint: "Extract target language: English=en, 中文/繁體=zh-tw, 日文=ja"
      
      source_lang:
        type: str
        optional: true
        description: "Source language (default: auto-detect)"
        maps_to_step: "source_lang_step"
        extraction_hint: "Extract source language, default to auto for auto-detection"
    
    mcp_tool_params:
      command:
        type: string
        required: true
        description: "User original command"
      initial_data:
        type: object
        required: false
        description: "Initial data: file_path (required), target_lang (default: zh-tw), source_lang (default: auto)"
