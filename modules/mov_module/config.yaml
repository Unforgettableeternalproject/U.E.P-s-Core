module_name: "mov_module"
module_type: "frontend"
priority: 3

physics:
  gravity: 0.8               # 重力加速度
  damping: 0.978             # 通用阻尼（已棄用，保留相容性）
  ground_friction: 0.95      # 地面摩擦係數
  air_resistance: 0.95      # 空氣阻力係數（調高以減少空中慣性衰減）
  bounce_factor: 0.4         # 地面反彈係數
  ground_offset: 48          # 地面偏移量

movement:
  ground_speed: 2.2
  float_speed_min: 1.0
  float_speed_max: 3.5
  approach_factor: 0.12       # → 速度趨近係數（原本硬編）
  target_reach_threshold: 50  # 增加到達閾值，讓移動更持久

state_machine:
  transition_duration: 2.0
  idle:
    min_duration: 4.0          # 增加最小閒置時間（給 cursor tracking 更多時間）
    max_duration: 12.0         # 大幅增加最大閒置時間
    tick_chance: 0.02          # 進一步降低每 tick 結束閒置的機率（更穩定的 IDLE）
  # 調整權重讓轉換更容易觸發
  weights_ground:
    NORMAL_MOVE: 0.40         # 稍微降低移動機率
    IDLE: 0.30                # 降低閒置機率
    SPECIAL_MOVE: 0.20
    TRANSITION: 0.10          # 大幅提高轉換機率（從3%提高到20%）
  weights_float:
    NORMAL_MOVE: 0.35
    IDLE: 0.40                # 浮空時偏好閒置
    SPECIAL_MOVE: 0.20
    TRANSITION: 0.05          # 大幅提高轉換機率（從5%提高到25%）

boundaries:
  screen_padding: 20
  keep_on_screen: true
  bounce_off_edges: false
  # 邊界處理模式（新增，參考 desktop_pet.py）
  boundary_mode: "barrier"  # "barrier": 碰到邊界停止（預設）, "wrap": 從右邊出去左邊進來（循環模式）

timers:
  behavior_interval_ms: 100
  movement_interval_ms: 16

# 投擲參數（由 ThrowHandler 使用）
# 參考 desktop_pet.py 優化後的閾值
throw_threshold_speed: 400.0    # 投擲速度門檻 (px/s) - 從 200 調整到 400（更合理）
throw_threshold_dist: 100.0      # 投擲距離門檻 (px) - 從 30 調整到 45（更合理）
max_throw_speed: 110.0           # 最大投擲速度 (px/s) - 降低速度以減少飛行距離
throw_post_tease_delay: 3.0     # 投擲後調皮動畫延遲 (秒)

# 滑鼠追蹤參數
cursor_head_turn_sensitivity: 9  # 轉頭靈敏度（角度/幀），影響 turn_head 動畫幀數計算

# 入場/出場行為配置（動畫名稱由 ANI 模組管理）
entry_behavior:
  enabled: true
  mode: "FLOAT"                  # 入場後的模式 (GROUND/FLOAT)
  start_position: "top_left"   # 起始位置 (top_center/bottom_center/left/right/center)
  
exit_behavior:
  enabled: false                 # 出場功能預留

# 移動平滑化參數
movement_smoothing:
  enabled: true
  velocity_lerp_factor: 0.15     # 速度平滑係數 (0-1，越小越平滑)
  pause_damping: 0.85            # 暫停時的慣性減速係數
  resume_acceleration: 0.2       # 恢復時的加速係數

tease_tracking:
  time_window: 10.0            # 追蹤時間窗口 (秒)
  interaction_threshold: 5     # 互動次數閾值（拖曳+投擲）

interaction:
  drag_enabled: true
  throw_enabled: true
  drag:
    trigger_threshold: 5  # 開始拖曳的最小移動距離（像素）
    struggle_animation: struggle
    struggle_loop: true
  throw:
    velocity_threshold: 500.0  # [已棄用] 判定為投擲的速度閾值（像素/秒）
    max_velocity: 2000.0  # [已棄用] 最大投擲速度限制
    gravity_multiplier: 1.2  # [已棄用] 投擲時的重力倍數
  file_drop:
    enabled: false  # 預留功能
    accept_types:
      - ".txt"
      - ".md"
      - ".py"
      - ".json"

# ==================== 處理器與策略系統 ====================
handlers:
  layer:
    enabled: true
    priority: 100
  drag:
    enabled: true
    priority: 90
    throw_velocity_threshold: 500.0
    height_threshold: 100
  file_drop:
    enabled: false
    priority: 80

animation_strategies:
  priority_order:
    - interaction  # 最高優先級
    - layer        # 中等優先級
    - state        # 基礎優先級
  layer:
    enabled: true
    priority: 50
  interaction:
    enabled: true
    priority: 100

debug:
  show_velocity_vector: false
  log_mode_changes: false
  track_cursor: false
  log_handler_chain: false
  log_strategy_selection: false
  log_animation_triggers: false
