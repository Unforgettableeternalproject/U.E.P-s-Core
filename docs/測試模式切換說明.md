# UEP 測試模式切換說明

## 概述

UEP系統現在支援兩種手動測試模式，每種模式都有不同的模組載入策略：

1. **終端測試模式** - 預先載入非UI模組
2. **GUI測試模式** - 按需載入所有模組

## 測試模式詳細說明

### 1. 終端測試模式（預先載入）

**啟動方式：**
```bash
python Entry.py  # debug.enabled = true 時
```

**特點：**
- 🚀 **預先載入**：系統啟動時載入所有核心模組（除UI外）
- ❌ **排除UI模組**：不載入 ui_module, ani_module, mov_module
- ⚡ **快速響應**：模組已載入完成，測試響應速度快
- 🔧 **適用於**：核心功能測試、API測試、整合測試

**載入的模組：**
- ✅ stt_module（語音轉文字）
- ✅ nlp_module（自然語言處理）
- ✅ mem_module（記憶管理）
- ✅ llm_module（大型語言模型）
- ✅ tts_module（文字轉語音）
- ✅ sys_module（系統功能）
- ❌ ui_module（使用者介面）
- ❌ ani_module（動畫）
- ❌ mov_module（移動控制）

### 2. GUI測試模式（按需載入）

**啟動方式：**
```bash
python Entry.py --debug-gui
```

**特點：**
- 🎯 **按需載入**：只在需要時載入模組
- ✅ **包含UI模組**：可以載入所有模組，包括UI相關
- 🖥️ **圖形介面**：提供圖形化的除錯介面
- 🔄 **動態管理**：可以動態載入/卸載模組

## 模式切換

### 從終端模式切換到GUI模式

在終端測試介面中輸入：
```
> gui
```

系統會：
1. 切換到按需載入模式
2. 啟動圖形除錯介面
3. 返回時自動切換回終端模式

### 前端模組測試

在終端模式下嘗試測試前端模組時：
- 系統會提示建議切換到GUI模式
- 用戶可以選擇繼續或切換模式
- 前端測試建議在GUI模式下進行

## 技術實現

### 載入模式控制

```python
# 設定為終端模式（預先載入非UI模組）
debug_api.set_loading_mode(preload=True)

# 設定為GUI模式（按需載入）
debug_api.set_loading_mode(preload=False)

# 便捷切換函數
debug_api.switch_to_terminal_mode()
debug_api.switch_to_gui_mode()
```

### 模組狀態檢查

```python
import devtools.debug_api as api

# 檢查載入模式
print("預先載入模式:", api.PRELOAD_MODULES)

# 檢查模組狀態
print("UI模組:", api.modules['ui'])  # 終端模式下為 None
print("STT模組:", api.modules['stt'])  # 終端模式下已載入
```

## 最佳實踐

### 終端測試模式適用於：
- 🔧 API功能測試
- 🔄 模組整合測試
- 📊 性能測試
- 🐛 核心邏輯除錯

### GUI測試模式適用於：
- 🖥️ 使用者介面測試
- 🎨 動畫效果測試
- 🎮 互動功能測試
- 📱 前端整合測試

## 故障排除

### 常見問題

1. **UI模組在終端模式下無法載入**
   - ✅ 這是正常行為，請切換到GUI模式

2. **從GUI模式返回終端模式後功能異常**
   - 🔄 系統會自動重新初始化，稍候片刻即可

3. **模組載入失敗**
   - 📋 檢查配置文件中的模組啟用狀態
   - 🔍 查看日誌文件了解詳細錯誤信息

### 日誌查看

相關日誌信息會顯示當前的載入模式：
```
[Controller] 設定載入模式：預先載入
[Controller] 初始化：預先載入模組（終端模式，排除UI）
```

或

```
[Controller] 設定載入模式：按需載入
[Controller] 初始化：按需載入模式
```

## 總結

通過這種雙模式設計，開發者可以：
- 在終端模式下快速測試核心功能
- 在GUI模式下測試完整的使用者體驗
- 靈活切換而不需要重新啟動程式
- 避免UI相關依賴在純邏輯測試中造成問題