# U.E.P's Core 專案結構說明

本文檔說明 U.E.P's Core 專案的目錄結構與各組件職責，幫助開發人員快速理解專案架構。

## 頂層目錄說明

| 目錄/檔案 | 用途說明 |
|----------|---------|
| **arts/** | 存放藝術資源、圖示、視覺設計元素 |
| **configs/** | 全局及模組配置文件 |
| **core/** | 核心系統組件，包含控制器、路由器等 |
| **devtools/** | 開發者工具與調試助手 |
| **docs/** | 文檔、規範與開發指南 |
| **logs/** | 日誌文件，按類型和月份組織 |
| **memory/** | 記憶相關檔案，包含索引與持久化資料 |
| **models/** | 模型文件存儲（NLP、TTS等） |
| **modules/** | 功能模組集合，每個子目錄為獨立模組 |
| **utils/** | 通用工具和輔助函數 |
| **entry.py** | 程序主入口點 |
| **requirements.txt** | Python 依賴列表 |

## 核心組件說明

### core/ 目錄

核心系統組件，負責協調各模組間的通信與控制流程：

| 檔案 | 功能說明 |
|------|---------|
| **controller.py** | 主控制器，負責初始化和協調各模組 |
| **module_base.py** | 模組基類，定義標準接口 |
| **registry.py** | 模組註冊表，動態載入模組實例 |
| **router.py** | 消息路由器，根據意圖和狀態決定執行路徑 |
| **session_manager.py** | 會話管理器，追蹤多步驟工作流程 |
| **state_manager.py** | 狀態管理器，處理系統狀態轉換 |

### modules/ 目錄

功能模組集合，每個子目錄為獨立模組：

| 模組目錄 | 功能說明 |
|---------|---------|
| **stt_module/** | 語音識別模組，負責將語音轉換為文字 |
| **nlp_module/** | 自然語言處理模組，負責意圖識別與語義理解 |
| **mem_module/** | 記憶管理模組，處理短期和長期記憶 |
| **llm_module/** | 大型語言模型整合，處理對話與指令生成 |
| **tts_module/** | 文本轉語音模組，生成語音回饋 |
| **sys_module/** | 系統功能模組，處理檔案、視窗控制等系統操作 |
| **ani_module/** | 動畫模組，控制桌面角色的動畫效果（開發中） |
| **mov_module/** | 移動模組，處理桌面角色的移動與位置（開發中） |
| **ui_module/** | 使用者介面模組，提供視覺交互元素（開發中） |

### 標準模組結構

每個功能模組通常包含以下文件：

```
modules/example_module/
├── __init__.py        # 模組註冊點
├── example_module.py  # 主模組實現
├── config.yaml        # 模組特定配置
├── schemas.py         # 資料結構定義
└── actions/           # 功能實現子目錄
```

## 工作流程引擎

系統支援複雜的多步驟工作流程，主要實現在：

| 檔案 | 功能說明 |
|------|---------|
| **modules/sys_module/workflows.py** | 核心工作流程引擎與基礎設施 |
| **modules/sys_module/workflows/** | 各類型工作流程實現 |

## 配置體系

系統採用分層配置機制：

| 檔案 | 功能說明 |
|------|---------|
| **configs/config.yaml** | 全局配置，包括模組啟用/禁用 |
| **configs/config_loader.py** | 配置加載器 |
| **modules/*/config.yaml** | 模組特定配置 |

## 日誌系統

系統採用按類型和月份組織的日誌系統：

| 目錄 | 功能說明 |
|------|---------|
| **logs/debug/** | 除錯日誌，按月份子目錄組織 |
| **logs/runtime/** | 運行日誌，按月份子目錄組織 |
| **logs/error/** | 錯誤日誌，按月份子目錄組織 |

## 開發指南

新功能開發應遵循以下原則：

1. **模組化設計**：所有新功能應作為獨立模組或現有模組的擴展
2. **統一接口**：遵循 `core/module_base.py` 中定義的標準接口
3. **配置驅動**：功能應通過配置文件控制，避免硬編碼
4. **錯誤處理**：實現完善的錯誤處理與回退機制
5. **日誌記錄**：關鍵操作應有適當級別的日誌記錄

詳細開發規範請參考 `docs/專案開發準則.md`。
